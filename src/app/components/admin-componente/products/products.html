<div class="products-container container-fluid py-4">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4 p-3 bg-light rounded-3 shadow-sm">
        <h1 class="m-0 text-primary">
            <i class="bi bi-box-seam me-2"></i>Productos
        </h1>
        <button class="btn btn-success">
            <i class="bi bi-plus-circle me-2"></i>Agregar Producto
        </button>
    </div>

    <!-- Products Grid -->
    <div class="mb-4">
        <ng-container *ngIf="products.length > 0">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-4">
                <div class="col" *ngFor="let product of products">
                    <div class="card h-100 product-card shadow-sm border-0">
                        <img [src]="product.product_image" class="card-img-top p-3" alt="{{ product.product_name }}"
                            style="height: 200px; object-fit: contain;">
                        <div class="card-body d-flex flex-column justify-content-between gap-2">
                            <h5 class="card-title text-wrap text-center">{{ product.product_name }}</h5>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="h5 text-primary">CLP {{ product.product_price | number:'1.0-0' }}</span>
                                </div>
                                <div>
                                    <a [href]="product.product_link" target="_blank"
                                        class="btn btn-outline-primary btn-sm">
                                        Ver Detalles
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>

        <!-- Empty State -->
        <ng-container *ngIf="products.length === 0">
            <div class="text-center py-5">
                <i class="bi bi-box-open display-4 text-muted mb-3"></i>
                <h3 class="text-muted">No se encontraron productos</h3>
                <p class="text-muted">Intenta ajustar tu b√∫squeda o filtro</p>
                <button class="btn btn-primary mt-3">Actualizar Productos</button>
            </div>
        </ng-container>
    </div>

    <!-- Pagination -->
    <div *ngIf="totalPages > 1" class="d-flex flex-column align-items-center mt-4">
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <!-- First Page Button -->
                <li class="page-item" [class.disabled]="page === 1">
                    <button class="page-link" (click)="changePage(1)" aria-label="First">
                        <span aria-hidden="true">&laquo;&laquo;</span>
                    </button>
                </li>

                <!-- Previous Page Button -->
                <li class="page-item" [class.disabled]="page === 1">
                    <button class="page-link" (click)="changePage(page - 1)" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </button>
                </li>

                <!-- Show first page + ellipsis if needed -->
                <ng-container *ngIf="getDisplayedPages()[0] > 1">
                    <li class="page-item">
                        <button class="page-link" (click)="changePage(1)">1</button>
                    </li>
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                </ng-container>

                <!-- Displayed Pages -->
                <li class="page-item" *ngFor="let p of getDisplayedPages()" [class.active]="p === page">
                    <button class="page-link" (click)="changePage(p)">{{ p }}</button>
                </li>

                <!-- Show last page + ellipsis if needed -->
                <ng-container *ngIf="getDisplayedPages()[getDisplayedPages().length - 1] < totalPages">
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                    <li class="page-item">
                        <button class="page-link" (click)="changePage(totalPages)">{{ totalPages }}</button>
                    </li>
                </ng-container>

                <!-- Next Page Button -->
                <li class="page-item" [class.disabled]="page === totalPages">
                    <button class="page-link" (click)="changePage(page + 1)" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </button>
                </li>

                <!-- Last Page Button -->
                <li class="page-item" [class.disabled]="page === totalPages">
                    <button class="page-link" (click)="changePage(totalPages)" aria-label="Last">
                        <span aria-hidden="true">&raquo;&raquo;</span>
                    </button>
                </li>
            </ul>
        </nav>
        <small class="text-muted mt-2">Showing page {{ page }} of {{ totalPages }}</small>
    </div>
</div>